(()=>{"use strict";(()=>{function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.select=e,this.value=this.select.querySelector(".select__value"),this.menu=this.select.querySelector(".select__menu"),this.options=this.select.querySelectorAll(".select__menu .select__item"),this.input=this.select.querySelector(".select__input"),this.selectActiveClass="select--isActive",this.menuActiveClass="select__menu--isActive",this.init()}var n,o;return n=t,(o=[{key:"init",value:function(){var e=this;this.select.addEventListener("click",(function(){return e.toggleMenu()})),this.options.forEach((function(t){t.addEventListener("click",(function(){return e.setValue(t)}))}));var t=this.getValue();if(t){var n=this.select.querySelector('[data-value="'.concat(t,'"]'));this.setValue(n)}}},{key:"toggleMenu",value:function(){this.select.classList.toggle(this.selectActiveClass),this.menu.classList.toggle(this.menuActiveClass)}},{key:"setValue",value:function(e){var t=e.getAttribute("data-value"),n=e.cloneNode(!0);this.input&&(this.input.value=t),this.select.setAttribute("data-value",t),this.value.innerHTML="",this.value.appendChild(n)}},{key:"getValue",value:function(){return this.input?this.input.value:this.select.getAttribute("data-value")}}])&&e(n.prototype,o),t}();function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modal=t,this.body=document.body,this.closeButton=this.modal.querySelector(".modal__close"),this.modalActiveClass="modal--isActive",this.noScrollClass="no-scroll",this.init()}var t,o;return t=e,(o=[{key:"init",value:function(){var e=this;this.closeButton.addEventListener("click",(function(){return e.close()}))}},{key:"open",value:function(){this.modal.classList.add(this.modalActiveClass),this.body.classList.add(this.noScrollClass)}},{key:"close",value:function(){this.modal.classList.remove(this.modalActiveClass),this.body.classList.remove(this.noScrollClass)}}])&&n(t.prototype,o),e}();var i=new t(document.querySelector("#selectServer")),c=new t(document.querySelector("#paymentMethod")),s=document.querySelector("#paymentForm"),a=document.querySelector("#errorGroup"),r=document.querySelector("#errorText"),l=document.querySelector("#donateModal"),u=document.querySelector("#donateModalServer"),d=document.querySelector("#donateModalNickname"),h=document.querySelector("#donateModalSum"),v=document.querySelector("#donateModalNSum"),m=document.querySelector("#donateModalCancel"),f=document.querySelector("#donateModalOk"),y=new o(l);function p(e){if(!e)return a.style.display="none",void(r.innerHTML="");a.style.display="",r.innerHTML=e}var S=!1,g=document.querySelector("#submitButton .button__text");function _(e){S=e,e?(g.innerHTML="Пожалуйста, подождите",p("")):g.innerHTML="Пополнить"}s.addEventListener("submit",(function(e){e.preventDefault();var t=new FormData(s),n=i.getValue(),o=t.get("account"),c=t.get("sum");if(0==n)return p("Выберите сервер!"),!1;u.innerText=1==n?"Odin":"Poseidon",d.innerText=o,h.innerText=c,y.open()})),m.addEventListener("click",(function(e){y.close()})),f.addEventListener("click",(function(e){y.close();var t=new FormData(s),n=t.get("account"),o=t.get("sum"),a=i.getValue(),r=c.getValue();if(!S){var l="https://namalsk-rp.ru/php/donate.php?account=".concat(n,"&sum=").concat(o,"&server_id=").concat(a,"&type=").concat(r,"&rand=").concat(Date.now());window.is_ik_test&&(l+="&test_ik="+is_ik_test),_(!0),fetch(l).then((function(e){return e.json()})).then((function(e){if(_(!1),!e||!e.answer)return p("Проблема с подключением к серверу. Попробуйте позже.");"not_account"===e.answer&&p("Такого аккаунта не существует. Проверьте правильность введенных данных."),!0===e.answer&&(document.location.href=e.url)})).catch((function(){_(!1),p("Проблема с подключением к серверу. Попробуйте позже.")}))}}));var q=document.querySelector("#sumAmount"),b=document.querySelector("#amountGroup"),k=document.querySelector("#amountText span");q.addEventListener("change",(function(e){var t=q.value.replace(/\D/g,"");t!==q.value&&(q.value=t);var n=Math.floor(parseInt(t)/gCurItemPrice);b.style.display="",k.innerText=n,v.innerText=n}))})()})();